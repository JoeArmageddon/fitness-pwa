@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── CSS Variables — Dark Mode ──────────────────────────── */
@layer base {
  :root {
    --bg-primary:    #060608;
    --bg-secondary:  #0d0d12;
    --surface-1:     rgba(255,255,255,0.04);
    --surface-2:     rgba(255,255,255,0.07);
    --glass:         rgba(255,255,255,0.05);
    --glass-border:  rgba(255,255,255,0.10);
    --glass-hover:   rgba(255,255,255,0.08);
    --text-primary:   rgba(255,255,255,0.95);
    --text-secondary: rgba(255,255,255,0.55);
    --text-tertiary:  rgba(255,255,255,0.30);
    --blue:    #0A84FF;
    --green:   #30D158;
    --orange:  #FF9F0A;
    --red:     #FF453A;
    --purple:  #BF5AF2;

    /* Tailwind compat */
    --background: 220 20% 4%;
    --foreground: 0 0% 95%;
    --card: 220 15% 7%;
    --card-foreground: 0 0% 95%;
    --primary: 211 100% 55%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 15% 12%;
    --secondary-foreground: 0 0% 55%;
    --muted: 220 15% 10%;
    --muted-foreground: 0 0% 38%;
    --accent: 142 70% 45%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 220 15% 12%;
    --input: 220 15% 10%;
    --ring: 211 100% 55%;
    --radius: 0.875rem;
  }

  * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }

  html { scroll-behavior: smooth; color-scheme: dark; }

  body {
    background: var(--bg-primary);
    color: var(--text-primary);
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Inter', system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
  }

  /* Ambient background glow */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 80% 50% at 15% 5%, rgba(10,132,255,0.09) 0%, transparent 55%),
      radial-gradient(ellipse 60% 40% at 85% 95%, rgba(191,90,242,0.07) 0%, transparent 55%),
      radial-gradient(ellipse 50% 35% at 50% 50%, rgba(48,209,88,0.03) 0%, transparent 65%);
    pointer-events: none;
    z-index: 0;
  }
  body > * { position: relative; z-index: 1; }
}

/* ── Components ─────────────────────────────────────────── */
@layer components {
  .card {
    background: var(--glass);
    backdrop-filter: blur(24px) saturate(180%);
    -webkit-backdrop-filter: blur(24px) saturate(180%);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 18px;
    transition: transform 0.18s cubic-bezier(.4,0,.2,1), background 0.18s;
  }

  .card-hover {
    @apply card;
    cursor: pointer;
  }
  .card-hover:active { transform: scale(0.974); background: var(--glass-hover); }

  .card-glow {
    @apply card;
    background: linear-gradient(135deg, rgba(255,255,255,0.07) 0%, rgba(255,255,255,0.03) 100%);
    border: 1px solid rgba(255,255,255,0.13);
    box-shadow: 0 8px 32px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.08);
  }

  .page-header {
    background: rgba(6,6,8,0.80);
    backdrop-filter: blur(28px) saturate(180%);
    -webkit-backdrop-filter: blur(28px) saturate(180%);
    border-bottom: 1px solid rgba(255,255,255,0.06);
    position: sticky;
    top: 0;
    z-index: 40;
    padding: 54px 16px 14px;
  }

  .page-title {
    font-size: 28px;
    font-weight: 800;
    letter-spacing: -0.8px;
    color: var(--text-primary);
  }

  .section-header {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1.2px;
    text-transform: uppercase;
    color: var(--text-tertiary);
    margin-bottom: 12px;
    padding: 0 2px;
  }

  .metric-value {
    font-size: 36px;
    font-weight: 800;
    letter-spacing: -1.2px;
    font-variant-numeric: tabular-nums;
  }

  .metric-label {
    font-size: 12px;
    color: var(--text-secondary);
    font-weight: 500;
  }

  .input-apple {
    width: 100%;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.10);
    border-radius: 14px;
    padding: 13px 16px;
    font-size: 15px;
    color: var(--text-primary);
    transition: all 0.2s;
    outline: none;
    font-family: inherit;
  }
  .input-apple::placeholder { color: var(--text-tertiary); }
  .input-apple:focus {
    background: rgba(255,255,255,0.09);
    border-color: rgba(10,132,255,0.5);
    box-shadow: 0 0 0 3px rgba(10,132,255,0.12);
  }

  .input-number {
    @apply input-apple;
    text-align: center;
    font-size: 26px;
    font-weight: 700;
    letter-spacing: -0.5px;
    padding: 14px;
  }

  .btn-primary {
    background: var(--blue);
    color: white;
    font-weight: 700;
    font-size: 16px;
    border-radius: 16px;
    padding: 15px 24px;
    border: none;
    cursor: pointer;
    transition: all 0.15s cubic-bezier(.4,0,.2,1);
    font-family: inherit;
    box-shadow: 0 4px 24px rgba(10,132,255,0.4);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    position: relative;
    overflow: hidden;
  }
  .btn-primary::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, rgba(255,255,255,0.2) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.15s;
  }
  .btn-primary:active { transform: scale(0.96); }
  .btn-primary:active::after { opacity: 1; }
  .btn-primary:disabled { opacity: 0.40; cursor: not-allowed; transform: none; box-shadow: none; }

  .btn-secondary {
    background: rgba(255,255,255,0.08);
    color: var(--text-primary);
    font-weight: 600;
    font-size: 16px;
    border-radius: 16px;
    padding: 15px 24px;
    border: 1px solid rgba(255,255,255,0.10);
    cursor: pointer;
    transition: all 0.15s;
    font-family: inherit;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }
  .btn-secondary:active { transform: scale(0.96); background: rgba(255,255,255,0.13); }

  .btn-ghost {
    background: transparent;
    color: var(--blue);
    font-weight: 600;
    padding: 8px 14px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    transition: all 0.15s;
    font-family: inherit;
    font-size: 14px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }
  .btn-ghost:active { background: rgba(10,132,255,0.12); }

  .progress-track {
    height: 5px;
    background: rgba(255,255,255,0.08);
    border-radius: 10px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    border-radius: 10px;
    transition: width 0.6s cubic-bezier(.4,0,.2,1);
  }

  .stat-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 5px 12px;
    border-radius: 100px;
    font-size: 13px;
    font-weight: 600;
    background: rgba(255,255,255,0.07);
    border: 1px solid rgba(255,255,255,0.10);
  }

  .skeleton {
    background: linear-gradient(90deg,
      rgba(255,255,255,0.04) 0%,
      rgba(255,255,255,0.08) 50%,
      rgba(255,255,255,0.04) 100%);
    background-size: 200% 100%;
    animation: shimmer 1.6s ease-in-out infinite;
    border-radius: 16px;
  }

  .sheet {
    background: linear-gradient(180deg, rgba(22,22,32,0.98) 0%, rgba(14,14,20,0.99) 100%);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border: 1px solid rgba(255,255,255,0.10);
    border-radius: 28px 28px 0 0;
    padding: 0 20px 40px;
    max-height: 92vh;
    overflow-y: auto;
  }
  .sheet-handle {
    width: 36px;
    height: 4px;
    background: rgba(255,255,255,0.15);
    border-radius: 2px;
    margin: 12px auto 20px;
  }
}

/* ── Utilities ──────────────────────────────────────────── */
@layer utilities {
  .scrollbar-hide::-webkit-scrollbar { display: none; }
  .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
  .pb-safe { padding-bottom: max(env(safe-area-inset-bottom), 12px); }
  .pt-safe { padding-top: env(safe-area-inset-top); }
}

/* ── Keyframes ──────────────────────────────────────────── */
@keyframes shimmer {
  0%   { background-position: -200% 0; }
  100% { background-position:  200% 0; }
}
@keyframes fade-up {
  from { opacity: 0; transform: translateY(14px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes fade-in {
  from { opacity: 0; }
  to   { opacity: 1; }
}
@keyframes scale-in {
  from { opacity: 0; transform: scale(0.93); }
  to   { opacity: 1; transform: scale(1); }
}
@keyframes slide-up {
  from { transform: translateY(100%); }
  to   { transform: translateY(0); }
}
@keyframes bounce-in {
  0%   { transform: scale(0.75); opacity: 0; }
  60%  { transform: scale(1.06); opacity: 1; }
  100% { transform: scale(1); }
}
@keyframes pulse-glow {
  0%, 100% { opacity: 0.7; }
  50%       { opacity: 1; }
}

.animate-fade-up   { animation: fade-up   0.35s cubic-bezier(.4,0,.2,1) both; }
.animate-fade-in   { animation: fade-in   0.25s ease both; }
.animate-scale-in  { animation: scale-in  0.22s cubic-bezier(.4,0,.2,1) both; }
.animate-slide-up  { animation: slide-up  0.36s cubic-bezier(.4,0,.2,1) both; }
.animate-bounce-in { animation: bounce-in 0.4s  cubic-bezier(.4,0,.2,1) both; }
.animate-spin      { animation: spin      0.8s  linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* Stagger delays */
.stagger > *:nth-child(1) { animation-delay: 0ms; }
.stagger > *:nth-child(2) { animation-delay: 55ms; }
.stagger > *:nth-child(3) { animation-delay: 110ms; }
.stagger > *:nth-child(4) { animation-delay: 165ms; }
.stagger > *:nth-child(5) { animation-delay: 220ms; }
.stagger > *:nth-child(6) { animation-delay: 275ms; }

/* Dark select options */
select option { background: #1a1a24; color: white; }
select.input-apple {
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='rgba(255,255,255,0.35)' d='M6 8L0 0h12z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 14px center;
  padding-right: 38px;
}

/* Number input no spinner */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; }
input[type=number] { -moz-appearance: textfield; }